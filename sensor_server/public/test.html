<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Test</title>
</head>

<body>
    <h1>Test Page</h1>
    <div id="status">Loading...</div>
    <div id="log"></div>
    <script>
        const logDiv = document.getElementById('log');
        const statusDiv = document.getElementById('status');

        function log(msg) {
            console.log(msg);
            logDiv.innerHTML += msg + '<br>';
        }

        log('Script started');

        try {
            const protocol = location.protocol === 'https:' ? 'wss://' : 'ws://';
            log('Protocol: ' + protocol);
            log('Host: ' + location.host);

            const ws = new WebSocket(protocol + location.host + "/?type=phone");

            ws.onopen = () => {
                statusDiv.innerText = "Connected!";
                log("WebSocket opened");
            };

            ws.onerror = (e) => {
                log("WS Error: " + e);
            };

            ws.onclose = () => {
                statusDiv.innerText = "Closed";
                log("WebSocket closed");
            };

        } catch (e) {
            log('Error: ' + e.message);
        }
    </script>
</body>

</html>